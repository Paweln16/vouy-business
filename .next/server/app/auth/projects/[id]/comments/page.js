(()=>{var e={};e.id=297,e.ids=[297],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},4573:e=>{"use strict";e.exports=require("node:buffer")},77598:e=>{"use strict";e.exports=require("node:crypto")},57975:e=>{"use strict";e.exports=require("node:util")},8287:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>o});var a=s(70260),r=s(28203),i=s(25155),n=s.n(i),l=s(67292),d={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(t,d);let o=["",{children:["auth",{children:["projects",{children:["[id]",{children:["comments",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,40650)),"/Users/pawelniedzwiedz/Desktop/vouy-business/src/app/auth/projects/[id]/comments/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,95521)),"/Users/pawelniedzwiedz/Desktop/vouy-business/src/app/auth/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,71354)),"/Users/pawelniedzwiedz/Desktop/vouy-business/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,50042)),"/Users/pawelniedzwiedz/Desktop/vouy-business/src/app/not-found.tsx"]}],c=["/Users/pawelniedzwiedz/Desktop/vouy-business/src/app/auth/projects/[id]/comments/page.tsx"],p={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/auth/projects/[id]/comments/page",pathname:"/auth/projects/[id]/comments",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},22188:(e,t,s)=>{"use strict";s.r(t),s.d(t,{"00bcebb40af748360d3173b1776dfd0799709ea208":()=>a.C,"40ea56800d56936bda32cd1cadb6373068db5e5342":()=>h,"602b29eef00cea6ad8ae1c604f5d92bf056537389e":()=>x,"602c8709fdcf4a6f479ff290d544a00462faa494ee":()=>m,"605b65ca41235cba380fa2425f8a6273be12d9bf85":()=>a.J,"6064a694b4af394d5bcc7a30cab7e26e94972d790e":()=>j,"60d7b45ad4e9ffc42bb3cd9d63b735dbafd9b9848b":()=>g});var a=s(7939),r=s(21590);s(70376);var i=s(99184),n=s(16500);let l=n.z.object({title:n.z.string(),deadline:n.z.string(),details:n.z.string(),status:n.z.string(),netPrice:n.z.string(),tax:n.z.string(),price:n.z.string()}),d=n.z.object({title:n.z.string(),taggedUser:n.z.string(),projectId:n.z.string()});var o=s(42385),c=s(47735),p=s(53332),u=s(99344);let f=process.env.BASE_URL;async function x(e,t){let{isAuth:s}=await (0,p.g)();if(!s)return;let a=await (0,o.UL)(),r=a.get("session")?.value,n=l.safeParse({title:t.get("title"),deadline:t.get("deadline"),details:t.get("details"),status:t.get("status"),netPrice:t.get("netPrice"),tax:t.get("tax"),price:t.get("price")});return n.success?(await fetch(f+"/api/projects",{method:"POST",body:JSON.stringify(n.data),headers:{"Content-Type":"application/json",Authorization:`${r}`}})).ok?((0,c.revalidatePath)("/auth/projects"),(0,i.redirect)("/auth/projects")):{message:"Enter valid data"}:{errors:n.error?.flatten().fieldErrors}}async function m(e,t){let{isAuth:s}=await (0,p.g)();if(!s)return;let a=await (0,o.UL)(),r=a.get("session")?.value,i=l.safeParse({title:e.get("title"),deadline:e.get("deadline"),details:e.get("details"),status:e.get("status"),netPrice:e.get("netPrice"),tax:e.get("tax"),price:e.get("price")});return i.success?(await fetch(f+`/api/projects/${t}`,{headers:{"Content-Type":"application/json",Authorization:`${r}`},method:"PUT",body:JSON.stringify(i.data)})).ok?void(0,c.revalidatePath)("/auth/projects"):{message:"Enter valid data"}:{errors:i.error?.flatten().fieldErrors}}async function h(e){let{isAuth:t}=await (0,p.g)();if(!t)return;let s=await (0,o.UL)(),a=s.get("session")?.value;if(!(await fetch(f+`/api/projects/${e}`,{headers:{"Content-Type":"application/json",Authorization:`${a}`},method:"DELETE"})).ok)return{message:"Enter valid data"};(0,c.revalidatePath)("/auth/projects"),(0,i.redirect)("/auth/projects")}async function g(e,t){let{isAuth:s}=await (0,p.g)();if(!s)return;let a=await (0,o.UL)(),r=a.get("session")?.value,n=d.safeParse({title:t.get("title"),taggedUser:t.get("taggedUser"),projectId:t.get("projectId")});if(!n.success)return{errors:n.error?.flatten().fieldErrors};let l=n.data.projectId;return(await fetch(f+`/api/projects/${l}/comments`,{method:"POST",headers:{"Content-Type":"application/json",authorization:`${r}`},body:JSON.stringify(n.data)})).ok?((0,c.revalidatePath)(`/auth/projects/${l}/comments`),(0,i.redirect)(`/auth/projects/${l}/comments`)):{message:"Enter valid data"}}async function j(e,t){let{isAuth:s}=await (0,p.g)();if(!s)return;let a=await (0,o.UL)(),r=a.get("session")?.value;return(await fetch(f+`/api/projects/${e}/comments`,{method:"DELETE",headers:{authorization:`${r}`},body:JSON.stringify({commentId:t})})).ok?((0,c.revalidatePath)(`/auth/projects/${e}/comments`),(0,i.redirect)(`/auth/projects/${e}/comments`)):{message:"Enter valid data"}}(0,u.D)([x,m,h,g,j]),(0,r.A)(x,"602b29eef00cea6ad8ae1c604f5d92bf056537389e",null),(0,r.A)(m,"602c8709fdcf4a6f479ff290d544a00462faa494ee",null),(0,r.A)(h,"40ea56800d56936bda32cd1cadb6373068db5e5342",null),(0,r.A)(g,"60d7b45ad4e9ffc42bb3cd9d63b735dbafd9b9848b",null),(0,r.A)(j,"6064a694b4af394d5bcc7a30cab7e26e94972d790e",null)},58836:(e,t,s)=>{Promise.resolve().then(s.bind(s,23496))},77396:(e,t,s)=>{Promise.resolve().then(s.bind(s,96340))},96340:(e,t,s)=>{"use strict";s.d(t,{default:()=>p});var a=s(45512),r=s(26248);let i=(0,r.createServerReference)("60d7b45ad4e9ffc42bb3cd9d63b735dbafd9b9848b",r.callServer,void 0,r.findSourceMapURL,"createProjectComment");var n=s(26008),l=s(58009);let d=(0,r.createServerReference)("6064a694b4af394d5bcc7a30cab7e26e94972d790e",r.callServer,void 0,r.findSourceMapURL,"deleteProjectComment");var o=s(19936);function c({commentId:e,projectId:t}){let[s,r]=(0,l.useTransition)();return(0,a.jsxs)("div",{className:"w-full h-full flex items-center",children:[(0,a.jsx)("button",{className:" h-full w-full flex items-center justify-center pt-[25px]",value:e,onClick:async()=>{r(async()=>{await d(t,e)})},children:"Delete"}),s&&(0,a.jsx)(o.A,{message:"Deleting comment..."})]})}function p({comments:e,users:t,projectId:s,userId:r}){let[d,p,u]=(0,l.useActionState)(i,{errors:{title:[],tag:[]}});return(0,a.jsxs)("div",{className:"h-full w-full flex",children:[(0,a.jsx)("div",{className:"h-full w-[20%] bg-[#fbfbfb] flex items-center justify-center",children:(0,a.jsxs)("div",{className:"w-[60%] flex flex-col items-center gap-[10px]",children:[(0,a.jsxs)("div",{className:"flex gap-[10px] items-center justify-start w-full",children:[(0,a.jsx)("span",{className:"h-[10px] w-[10px] rounded-[20px] bg-[#2d2d2d]"}),(0,a.jsx)(n.default,{href:`/auth/projects/${s}`,className:"text-[20px] text-[#2d2d2d]",children:"General info"})]}),(0,a.jsxs)("div",{className:"flex gap-[10px] items-center justify-start w-full",children:[(0,a.jsx)("span",{className:"h-[10px] w-[10px] bg-[#a2a2a2] rounded-[20px]"}),(0,a.jsx)(n.default,{href:`/auth/projects/${s}/comments`,className:"text-[20px] text-[#a2a2a2]",children:"Comments"})]})]})}),(0,a.jsx)("div",{className:"h-full w-[80%] bg-white p-[30px]",children:(0,a.jsxs)("div",{className:"h-full w-[50%] flex flex-col gap-[10px]",children:[(0,a.jsx)("span",{className:"text-[25px]",children:"Comments"}),(0,a.jsx)("div",{className:"max-h-[50%] w-full flex flex-col gap-[20px] overflow-y-scroll",children:e.map(e=>(0,a.jsxs)("div",{className:"flex gap-[20px]  h-[75px] w-full items-center",children:[(0,a.jsxs)("div",{className:"h-full w-[65%] flex flex-col gap-[10px]",children:[(0,a.jsx)("span",{children:"Comment"}),(0,a.jsx)("p",{className:"h-full flex items-center pl-[10px] w-full border-[1px] rounded-[10px]  outline-none",children:e.title})]}),(0,a.jsxs)("div",{className:"flex flex-col w-[25%] h-full gap-[10px]",children:[(0,a.jsx)("span",{children:"Tag"}),(0,a.jsx)("p",{className:"h-full w-full border-[1px] flex items-center pl-[10px] rounded-[10px] ",children:e.taggedUser.name})]}),(0,a.jsx)("div",{className:"w-[10%]",children:e.creatorId===r&&(0,a.jsx)(c,{commentId:e.id,projectId:s})})]},e.id))}),(0,a.jsxs)("form",{id:"createProjectCommentForm",action:p,className:"w-full flex flex-col gap-[10px]",children:[(0,a.jsx)("input",{type:"hidden",name:"projectId",value:s}),(0,a.jsxs)("div",{className:"flex w-full h-[75px] gap-[20px]",children:[(0,a.jsxs)("div",{className:"h-full w-[65%] flex flex-col gap-[10px]",children:[(0,a.jsx)("span",{children:"Comment"}),(0,a.jsx)("input",{type:"text",name:"title",className:"h-full w-full border-[1px] rounded-[10px] pl-[10px] outline-none"})]}),(0,a.jsxs)("div",{className:"flex flex-col w-[25%] gap-[10px]",children:[(0,a.jsx)("span",{children:"Tag"}),(0,a.jsx)("select",{name:"taggedUser",className:"h-full w-full border-[1px] rounded-[10px] ",children:t.map((e,t)=>(0,a.jsx)("option",{value:e.id,children:e.name},t))})]}),(0,a.jsx)("div",{className:"w-[10%] h-full"})]}),d?.errors?.title&&(0,a.jsx)("p",{children:d.errors.title}),(0,a.jsxs)("div",{className:"w-full flex gap-[40px]",children:[(0,a.jsx)("button",{type:"submit",form:"createProjectCommentForm",disabled:u,className:"w-[65%] h-[45px] bg-[#2d2d2d] text-white rounded-[10px]",children:"Add Comment"}),(0,a.jsx)("div",{className:"w-[35%]"})]})]})]})}),u&&(0,a.jsx)(o.A,{message:"Creating comment..."})]})}},19936:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(45512),r=s(91680),i=s.n(r);function n({message:e}){return(0,a.jsx)("div",{className:i().loading,children:(0,a.jsx)("p",{children:e})})}},91680:e=>{e.exports={loading:"styles_loading__o4T_w"}},23496:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});let a=(0,s(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/pawelniedzwiedz/Desktop/vouy-business/src/app/auth/projects/[id]/comments/Comments/Comments.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/pawelniedzwiedz/Desktop/vouy-business/src/app/auth/projects/[id]/comments/Comments/Comments.tsx","default")},40650:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(62740),r=s(71444),i=s(23496),n=s(44512),l=s(96681);async function d({params:e}){let t=await (0,n.UL)(),s=t.get("session")?.value,d=(await (0,l.g)()).userId,o=(await e).id,c=await (0,r.W7)(s,o),p=await (0,r.lo)(s);return(0,a.jsx)("div",{className:"h-screen w-screen pt-[100px]",children:(0,a.jsx)(i.default,{comments:c,userId:d,projectId:o,users:p})})}},53332:(e,t,s)=>{"use strict";s.d(t,{g:()=>n});var a=s(42385),r=s(6439),i=s(99184);let n=async()=>{let e=(await a.UL()).get("session")?.value,t=await (0,r.Yc)(e);return t?.userId||(0,i.redirect)("/login"),{isAuth:!0,userId:t?.userId,organizationId:t?.organizationId}}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[989,405,892,155,200,735,476],()=>s(8287));module.exports=a})();