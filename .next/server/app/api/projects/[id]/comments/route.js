(()=>{var e={};e.id=519,e.ids=[519],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},77598:e=>{"use strict";e.exports=require("node:crypto")},57975:e=>{"use strict";e.exports=require("node:util")},69211:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>w,routeModule:()=>x,serverHooks:()=>g,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>j});var r={};s.r(r),s.d(r,{DELETE:()=>m,GET:()=>p,POST:()=>l});var n=s(42706),o=s(28203),a=s(45994),i=s(65233),u=s(3930),c=s(61482),d=s(39187);async function p(e,{params:t}){let s=e.headers.get("authorization"),r=await (0,u.Yc)(s);if(!s||!r)return d.NextResponse.json({message:"Unauthorized"},{status:401});let{id:n}=await t;try{let e=await i.A.comment.findMany({where:{projectId:n},include:{taggedUser:{select:{name:!0}}}});return console.log(e),d.NextResponse.json(e)}catch(e){return d.NextResponse.json({error:e},{status:500})}}async function l(e){let t=e.headers.get("authorization"),s=await (0,u.Yc)(t);if(!t||!s)return d.NextResponse.json({message:"Unauthorized"},{status:401});let r=s.userId,{title:n,taggedUser:o,projectId:a}=await e.json();try{return await i.A.comment.create({data:{title:n,userId:o,projectId:a,creatorId:r}}),(0,c.revalidatePath)(`/auth/projects/${a}/commnets`),d.NextResponse.json({message:"Comment created"},{status:201})}catch(e){return d.NextResponse.json({error:e},{status:500})}}async function m(e){let t=e.headers.get("authorization"),s=await (0,u.Yc)(t);if(!t||!s)return d.NextResponse.json({message:"Unauthorized"},{status:401});let{commentId:r}=await e.json();console.log(r);try{return await i.A.comment.delete({where:{id:r}}),d.NextResponse.json({message:"Comment deleted"},{status:202})}catch(e){return d.NextResponse.json({error:e},{status:500})}}let x=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/projects/[id]/comments/route",pathname:"/api/projects/[id]/comments",filename:"route",bundlePath:"app/api/projects/[id]/comments/route"},resolvedPagePath:"/Users/pawelniedzwiedz/Desktop/vouy-business/src/app/api/projects/[id]/comments/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:h,workUnitAsyncStorage:j,serverHooks:g}=x;function w(){return(0,a.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:j})}},96487:()=>{},78335:()=>{},65233:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=new(require("@prisma/client")).PrismaClient},3930:(e,t,s)=>{"use strict";s.d(t,{Yc:()=>a}),s(44512);var r=s(89888);let n=process.env.AUTH_SECRET,o=new TextEncoder().encode(n);async function a(e=""){try{let{payload:t}=await (0,r.V)(e,o,{algorithms:["HS256"]});return t}catch(e){console.log("Failed to verify session")}}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[989,155,452,416],()=>s(69211));module.exports=r})();